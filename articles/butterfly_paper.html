<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>butterfly: An R package for the verification of continually updating timeseries data where we expect new values, but want to ensure previous data remains unchanged. • butterfly</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="butterfly: An R package for the verification of continually updating timeseries data where we expect new values, but want to ensure previous data remains unchanged.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">butterfly</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/butterfly.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/butterfly_in_pipeline.html">Using butterfly in an operational data pipeline</a></li>
    <li><a class="dropdown-item" href="../articles/butterfly_paper.html">butterfly: An R package for the verification of continually updating timeseries data where we expect new values, but want to ensure previous data remains unchanged.</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/thomaszwagerman/butterfly/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>butterfly: An R package for the verification of continually updating timeseries data where we expect new values, but want to ensure previous data remains unchanged.</h1>
            
            <h4 data-toc-skip class="date">23 October 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/thomaszwagerman/butterfly/blob/main/vignettes/articles/butterfly_paper.Rmd" class="external-link"><code>vignettes/articles/butterfly_paper.Rmd</code></a></small>
      <div class="d-none name"><code>butterfly_paper.Rmd</code></div>
    </div>

    
    
<p>#&gt; left out bibliography: paper.bib from yaml</p>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>Previously recorded data could be revised after initial publication
number of reasons, such as discovery of an inconsistency or error, a
change in methodology or instrument re-calibration. When using other
data to generate your own, it is crucial to reference the exact version
of the data used, in order to maintain data provenance. Unnoticed
changes in previous data could have unintended consequences, such as
invalidating a published dataset’s Digital Object Identfier (DOI), or
altering future predictions if used as input in forecasting models.</p>
<p>But what if you are not aware of upstream changes to your input data?
Monitoring data sources for these changes is not always possible. Here
we present butterfly, an R package for the verification of continually
updating timeseries data where we expect new values, but want to ensure
previous data remains unchanged.</p>
<p>The intention of butterfly is to check for changes in previously
published data, and warn the user with a report that contains as much
details as possible. This will allow them to stop unintended data
transfer, revise their published data, release a new version and
communicate the significance of the change to their users.</p>
</div>
<div class="section level2">
<h2 id="statement-of-need">Statement of Need<a class="anchor" aria-label="anchor" href="#statement-of-need"></a>
</h2>
<p>Importance of citing exact extract of data <a href="https://datascience.codata.org/articles/10.5334/dsj-2021-012" class="external-link">(Klump
et al. 2021)</a></p>
<p>Semantic versioning is widely adopted in research software <a href="https://semver.org/spec/v2.0.0.html" class="external-link">(Preston-Werner 2013)</a></p>
<p>Generating a derived data product</p>
<p>A key recommendation in Siddorn et al.’s (2022) report “An
Information Management Framework for Environmental Digital Twins
(IMFe)…</p>
<p>data provenance must be maintained</p>
<p>data quality frameworks</p>
<p>clearly documented for users and available in machine-readable
format</p>
<p>tools and methods</p>
<p>… for a FAIR implementation (Wilkinson et al. 2016).</p>
<p>At the British Antarctic Survey (BAS), we developed this package to
deal with a very specific issue.</p>
<p>Quality assurance in continually updating and continually published
ERA5-derived data.</p>
<p>At BAS, we frequently use ERA5 (Hersbach et al. 2023) as an input to
climate models.</p>
<p>IceNet a sea ice prediction system based on deep learning (Andersson
et al. 2021)</p>
<p>ERA5-derived data.</p>
<div class="section level3">
<h3 id="the-issue-with-era5-and-era5-interim">The issue with ERA5 and ERA5-Interim<a class="anchor" aria-label="anchor" href="#the-issue-with-era5-and-era5-interim"></a>
</h3>
<p>This package was originally developed to deal with <a href="https://cds.climate.copernicus.eu/datasets/reanalysis-era5-single-levels?tab=documentation" class="external-link">ERA5</a>’s
initial release data, ERA5T. ERA5T data for a month is overwritten with
the final ERA5 data two months after the month in question.</p>
<p>Usually ERA5 and ERA5T are identical, but occasionally an issue with
input data can (for example for <a href="https://confluence.ecmwf.int/display/CKB/ERA5T+issue+in+snow+depth" class="external-link">09/21
- 12/21</a>, and <a href="https://forum.ecmwf.int/t/final-validated-era5-product-to-differ-from-era5t-in-july-2024/6685" class="external-link">07/24</a>)
force a recalculation, meaning previously published data differs from
the final product.</p>
<p>In most cases, this is not an issue. For static data publications
which are a snapshot in time, such as data associated with a specific
paper, as in “Forecasts, neural networks, and results from the paper:
‘Seasonal Arctic sea ice forecasting with probabilistic deep learning’”
<a href="https://data.bas.ac.uk/full-record.php?id=GB/NERC/BAS/PDC/01526" class="external-link">Andersson
&amp; Hosking (2021)</a><span class="citation">[@Andersson_2021]</span>
or time period as in “Downscaled ERA5 monthly precipitation data using
Multi-Fidelity Gaussian Processes between 1980 and 2012 for the Upper
Beas and Sutlej Basins, Himalaya” <a href="https://data.bas.ac.uk/full-record.php?id=GB/NERC/BAS/PDC/01769" class="external-link">Tazi
(2023)</a>, this is not an issue. These datasets clearly describe a
version and time period of ERA5 from which the data were derived, and
will not be amended or updated in the future, even if ERA5 is
recalculated.</p>
<p>In our case however we want to continually append ERA5-derived
datasets <strong>and</strong> continually publish them. This would be
useful when functioning as a data source for an environmental digital
twin (Blair &amp; Hnerys et al. 2023), or simply as input data into an
environmental forecasting model which itself is frequently running.</p>
<p>Continually appending <strong>and</strong> publishing will require
strict quality assurance. If a published dataset is only appended a DOI
can be minted for it.  However, if the previously published data change,
this will then invalidate the DOI.  For example, if you developed your
code to find a better measure (more accurate, more precise) of the low
pressure region, and wanted to reanalyse the previous data and
republish.</p>
<p>One such ERA5-derived dataset which we (will hopefully soon!) publish
at BAS is the Amundsen Sea Low Index (ASLI).</p>
</div>
<div class="section level3">
<h3 id="what-is-the-amundsen-sea-low-index">What is the Amundsen Sea Low Index<a class="anchor" aria-label="anchor" href="#what-is-the-amundsen-sea-low-index"></a>
</h3>
<p>The Amundsen Seas Low (ASL) is a highly dynamic and mobile
climatological low pressure system located in the Pacific sector of the
Southern Ocean. In this sector, variability in sea-level pressure is
greater than anywhere in the Southern Hemisphere, making it challenging
to isolate local fluctuations in the ASL from larger-scale shifts in
atmospheric pressure. The position and strength of the ASL are crucial
for understanding regional change over West Antarctica (Hosking et
al. 2016).</p>
</div>
</div>
<div class="section level2">
<h2 id="citations">Citations<a class="anchor" aria-label="anchor" href="#citations"></a>
</h2>
</div>
<div class="section level2">
<h2 id="acknowledgements">Acknowledgements<a class="anchor" aria-label="anchor" href="#acknowledgements"></a>
</h2>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Andersson, T., &amp; Hosking, J. (2021). Forecasts, neural networks,
and results from the paper: ‘Seasonal Arctic sea ice forecasting with
probabilistic deep learning’ (Version 1.0) [Data set]. NERC EDS UK Polar
Data Centre. <a href="https://doi.org/10.5285/71820e7d-c628-4e32-969f-464b7efb187c" class="external-link uri">https://doi.org/10.5285/71820e7d-c628-4e32-969f-464b7efb187c</a></p>
<p>Andersson, T.R., Hosking, J.S., Pérez-Ortiz, M. <em>et al.</em>
Seasonal Arctic sea ice forecasting with probabilistic deep learning.
<em>Nat Commun</em> <strong>12</strong>, 5124 (2021). <a href="https://doi.org/10.1038/s41467-021-25257-4" class="external-link uri">https://doi.org/10.1038/s41467-021-25257-4</a></p>
<p>Blair, Gordon S., and Peter A. Henrys. 2023. “The Role of Data
Science in Environmental Digital Twins: In Praise of the Arrows.”
Environmetrics 34 (January): Not available. <a href="https://doi.org/10.1002/env.2789" class="external-link uri">https://doi.org/10.1002/env.2789</a>.</p>
<p>Hersbach, H., Bell, B., Berrisford, P., Biavati, G., Horányi, A.,
Muñoz Sabater, J., Nicolas, J., Peubey, C., Radu, R., Rozum, I.,
Schepers, D., Simmons, A., Soci, C., Dee, D., Thépaut, J-N. (2023): ERA5
hourly data on single levels from 1940 to present. Copernicus Climate
Change Service (C3S) Climate Data Store (CDS), DOI:
10.24381/cds.adbb2d47</p>
<p>Hosking, J. S., A. Orr, T. J. Bracegirdle, and J. Turner (2016),
Future circulation changes off West Antarctica: Sensitivity of the
Amundsen Sea Low to projected anthropogenic forcing, Geophys. Res.
Lett., 43, 367–376, <a href="doi:10.1002/2015GL067143" class="uri">doi:10.1002/2015GL067143</a>.</p>
<p>Klump, J., Wyborn, L., Wu, M., Martin, J., Downs, R.R. and Asmi, A.
(2021) ‘Versioning Data Is About More than Revisions: A Conceptual
Framework and Proposed Principles’, Data Science Journal, 20(1), p. 12.
Available at: <a href="https://doi.org/10.5334/dsj-2021-012" class="external-link uri">https://doi.org/10.5334/dsj-2021-012</a>.</p>
<p>Preston-Werner, T. 2013. Semantic Versioning 2.0.0. Semantic
Versioning. Available at <a href="https://semver.org/spec/v2.0.0.html" class="external-link uri">https://semver.org/spec/v2.0.0.html</a> [Last accessed 28
October 2024].</p>
<p>Siddorn, John, Gordon Shaw Blair, David Boot, Justin James Henry
Buck, Andrew Kingdon, et al. 2022. “An Information Management Framework
for Environmental Digital Twins (IMFe).” Zenodo. <a href="https://doi.org/10.5281/ZENODO.7004351" class="external-link uri">https://doi.org/10.5281/ZENODO.7004351</a>.</p>
<p>Tazi, K. (2023). Downscaled ERA5 monthly precipitation data using
Multi-Fidelity Gaussian Processes between 1980 and 2012 for the Upper
Beas and Sutlej Basins, Himalayas (Version 1.0) [Data set]. NERC EDS UK
Polar Data Centre. <a href="https://doi.org/10.5285/b2099787-b57c-44ae-bf42-0d46d9ec87cc" class="external-link uri">https://doi.org/10.5285/b2099787-b57c-44ae-bf42-0d46d9ec87cc</a></p>
<p>Wilkinson, Mark D., Michel Dumontier, IJsbrand Jan Aalbersberg,
Gabrielle Appleton, Myles Axton, et al. 2016. “The FAIR Guiding
Principles for Scientific Data Management and Stewardship.” Scientific
Data 3 (1). <a href="https://doi.org/10.1038/sdata.2016.18" class="external-link uri">https://doi.org/10.1038/sdata.2016.18</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Zwagerman.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
